@model AIChatApp.Domain.DTOs.UserListDto

@{
    // Generate avatar initials
    string initials = "";
    if (!string.IsNullOrEmpty(Model.FullName))
    {
        var nameParts = Model.FullName.Trim().Split(' ');
        if (nameParts.Length >= 2)
        {
            initials = $"{nameParts[0][0]}{nameParts[nameParts.Length - 1][0]}".ToUpper();
        }
        else if (nameParts.Length == 1)
        {
            initials = nameParts[0][0].ToString().ToUpper();
        }
    }

    // High-end UI Avatars configuration
    string avatarUrl = $"https://ui-avatars.com/api/?name={Uri.EscapeDataString(initials)}&background=6366F1&color=fff&size=128&bold=true&font-size=0.35";
    string profileImageSource = !string.IsNullOrEmpty(Model.ProfileImageUrl) ? Model.ProfileImageUrl : avatarUrl;

    // Logic for "New" badge
    bool isNewMember = Model.CreatedAt > DateTime.Now.AddDays(-7);
}

<div class="relative flex items-center justify-between p-5 bg-white border border-slate-100 rounded-[2rem] shadow-sm transition-all duration-300">

    <div class="flex items-center gap-5 relative z-10">
        <!-- Avatar Section -->
        <div class="relative flex-shrink-0">
            <img src="@profileImageSource"
                 alt="@Model.FullName"
                 class="h-14 w-14 rounded-[1.2rem] object-cover bg-slate-50 border border-slate-100 relative z-10"
                 onerror="this.onerror=null;this.src='@avatarUrl';" />
        </div>

        <!-- User Information -->
        <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-0.5">
                <h4 class="text-sm font-black text-slate-900 leading-tight tracking-tight">
                    @Model.FullName
                </h4>
                @if (isNewMember)
                {
                    <span class="px-2 py-0.5 bg-indigo-50 text-indigo-600 text-[9px] font-black uppercase tracking-widest rounded-md border border-indigo-100">
                        New
                    </span>
                }
            </div>

            <div class="flex flex-col gap-1">
                <span class="text-[11px] text-slate-400 font-bold uppercase tracking-wider">
                    @@@Model.UserName
                </span>

                <!-- New Feature: Status & Meta Bar (No Hover Needed) -->
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-1.5">
                        <span class="h-1 w-1 rounded-full bg-slate-200"></span>
                        <span class="text-[10px] text-slate-400 font-medium">Joined @Model.CreatedAt.ToString("MMM yyyy")</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Persistent Action Button -->
    <div class="relative z-10">
        <a asp-controller="Chat"
           asp-action="Index"
           asp-route-userId="@Model.Id"
           class="flex items-center justify-center h-12 px-5 gap-2 rounded-2xl bg-slate-50 text-indigo-600 border border-slate-100 hover:bg-indigo-600 hover:text-white hover:border-indigo-600 hover:shadow-lg hover:shadow-indigo-100 transition-all duration-300 group/btn">
            <span class="text-[10px] font-black uppercase tracking-widest">Message</span>
            <i class="fa-solid fa-paper-plane text-[10px] opacity-70 group-hover/btn:translate-x-0.5 transition-transform"></i>
        </a>
    </div>
</div>